# 快速使用指南

## 🚀 启动测试平台

```bash
pnpm dev:playground
```

浏览器会自动打开测试平台（通常是 http://localhost:5173）

## 📋 测试平台功能

### 主页面
- 显示所有可用的测试项目
- 点击卡片进入具体测试
- 每个测试显示开发状态（稳定/测试中/实验性）

### 图片压缩测试

#### 支持的算法
1. **Browser Compression** - 当前插件使用的方案
   - 基于 browser-image-compression 库
   - 支持多线程处理

2. **jSquash WebP** - WebAssembly WebP 编码
   - 基于 libwebp
   - 纯前端处理

3. **jSquash AVIF** - 下一代图片格式
   - 基于 libavif
   - 压缩率最高

4. **jSquash JPEG** - MozJPEG 编码器
   - 经典 JPEG 格式
   - 兼容性最好

#### 测试步骤
1. 拖拽或点击上传图片
2. 选择压缩算法
3. 调整压缩质量（0.1-1.0）
4. 选择输出格式
5. 点击"开始压缩"
6. 查看压缩结果和对比
7. 下载压缩后的图片

#### 关键指标
- **原始大小** - 上传图片的文件大小
- **压缩后大小** - 压缩后的文件大小
- **压缩比** - 节省的百分比（越高越好）
- **压缩时间** - 压缩耗时（毫秒）

## 📊 预期测试结果

根据研究和行业数据：

### AVIF
- ✅ 比 JPEG 节省 ~50%
- ✅ 比 WebP 节省 ~20%
- ⚠️ 压缩时间较长
- ⚠️ 部分旧浏览器不支持

### WebP
- ✅ 比 JPEG 节省 ~25-35%
- ✅ 压缩速度快
- ✅ 浏览器支持广泛

### JPEG
- ✅ 兼容性最好
- ⚠️ 压缩率相对较低

## 🔧 后续集成

测试出最优方案后：

1. **更新插件代码**
   - 修改 `src/oceanpress-siyuan-plugin/` 中的压缩逻辑
   - 替换为测试中表现最好的算法

2. **考虑渐进增强**
   ```javascript
   // 示例：根据浏览器支持选择格式
   if (supportsAVIF) {
     useAVIF();
   } else if (supportsWebP) {
     useWebP();
   } else {
     useJPEG();
   }
   ```

3. **更新设置界面**
   - 添加算法选择选项
   - 添加格式选择选项
   - 保留现有的质量控制

## 🐛 常见问题

### Vite 启动失败
- 检查端口是否被占用
- 尝试杀掉其他 Node 进程

### jSquash 加载失败
- 确认依赖已安装：`pnpm add @jsquash/webp @jsquash/avif @jsquash/jpeg`
- 检查网络连接（WASM 文件需要下载）

### 图片压缩失败
- 检查浏览器控制台错误
- 确认图片格式受支持
- 尝试降低图片分辨率

## 📝 技术要点

### 为什么选择 jSquash？
1. **WebAssembly** - 接近原生性能
2. **模块化** - 按需引入，减小体积
3. **来源可靠** - 基于 Google Squoosh
4. **持续维护** - 活跃的开源项目

### AVIF vs WebP
- **AVIF**：压缩率更高，但速度较慢
- **WebP**：平衡性能和压缩率
- **建议**：提供用户选项，默认使用 WebP，高级用户可选择 AVIF

## 🎯 测试目标

通过这个测试平台，你应该能够：
1. ✅ 了解不同压缩算法的实际效果
2. ✅ 对比压缩率和性能
3. ✅ 找到最适合插件的方案
4. ✅ 为未来的优化提供数据支持
